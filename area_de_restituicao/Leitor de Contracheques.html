<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtro de Rubricas e Isolamento de Valores</title>
    <script>
        const dataLimite = new Date('2025-06-01');

        function verificarData() {
            const dataAtual = new Date();
            if (dataAtual > dataLimite) {
                alert('Erro. Favor entrar em contato com o criador: Marcos Oliveira.');
                document.body.innerHTML = '';
                return false;
            }
            return true;
        }

        window.onload = function() {
            verificarData();
        };

        const meses = {
            "Janeiro": "01",
            "Fevereiro": "02",
            "Março": "03",
            "Abril": "04",
            "Maio": "05",
            "Junho": "06",
            "Julho": "07",
            "Agosto": "08",
            "Setembro": "09",
            "Outubro": "10",
            "Novembro": "11",
            "Dezembro": "12"
        };

        const mesesAnos = [];
        for (let ano = 2019; ano <= 2025; ano++) {
            Object.keys(meses).forEach(mes => mesesAnos.push(`${mes}/${ano}`));
        }

        function converterDataParaNumerico(dataTexto) {
            const [mes, ano] = dataTexto.split('/');
            return `${meses[mes]}/${ano}`;
        }

        let resultadosFiltrados = {};

        function buscarRubricas() {
            const inputText = document.getElementById('inputText').value;
            const sections = {};

            mesesAnos.forEach(mesAno => {
                const regex = new RegExp(`${mesAno}(.*?)((?=${mesesAnos.join('|')})|$)`, 's');
                const match = inputText.match(regex);
                if (match) {
                    sections[mesAno] = match[1].trim();
                }
            });

            const container = document.getElementById('result');
            container.innerHTML = ''; // Limpa resultados anteriores

            for (const [mesAno, data] of Object.entries(sections)) {
                if (data) {
                    const resultDiv = document.createElement('div');
                    resultDiv.innerHTML = `<h2>${converterDataParaNumerico(mesAno)}</h2>`;
                    container.appendChild(resultDiv);

                    processMonthlyData(mesAno, data, resultDiv);
                }
            }

            resultadosFiltrados = sections; // Salva os dados filtrados para uso posterior
        }

        function processMonthlyData(mesAno, data, container) {
            const rubricas = ['0001', '0002', '0003', '0004', '0005', '0007', '0008', '0009', '0010', '0011', '0012', '0013', '0015', '0022', '3036'];
            const rubricasDetalhadas = {
                "7033": "Assistência a Saúde",
                "7035": "Planserv / Cônjuge",
                "7038": "Planserv Agregado Jovem",
                "7039": "Planserv Agregado Maior",
                "7034": "Planserv / Dependente",
                "7037": "Planserv Especial",
                "7040": "Co-participação Planserv",
                "7049": "Planserv Retroativo",
                "7088": "Parc Risco Planserv Titul",
                "7090": "Parc Risco Planserv Conj",
                "7089": "Parc Risco Planserv Dep",
                "7044": "Restituição Planserv",
                "7091": "Parc Risco Planserv Agreg"
            };

            const lines = data.split('\n');

            const proventosTable = document.createElement('table');
            proventosTable.innerHTML = `
                <thead>
                    <tr>
                        <th>Proventos</th>
                        <th>Descontos (desconsiderar)</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            let totalProventos = 0;

            lines.forEach(line => {
                const rubrica = line.substring(0, 4);
                if (rubricas.includes(rubrica)) {
                    const values = line.match(/\d{1,3}(?:\.\d{3})*,\d{2}/g);
                    if (values) {
                        const row = proventosTable.querySelector('tbody').insertRow();
                        const proventosCell = row.insertCell(0);
                        const descontosCell = row.insertCell(1);
                        proventosCell.textContent = values[0] || '';
                        descontosCell.textContent = values[1] || '';

                        if (values[0]) {
                            totalProventos += parseFloat(values[0].replace(/\./g, '').replace(',', '.'));
                        }
                    }
                }
            });

            container.appendChild(proventosTable);
            const totalProventosDiv = document.createElement('h3');
            totalProventosDiv.innerText = `Total de Proventos: ${totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            container.appendChild(totalProventosDiv);

            const rubricasTable = document.createElement('table');
            rubricasTable.innerHTML = `
                <thead>
                    <tr>
                        <th>Rubrica</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;

            lines.forEach(line => {
                Object.keys(rubricasDetalhadas).forEach(rubrica => {
                    const regex = new RegExp(`\\b${rubrica}\\b.*?(\\d{1,3}(?:\\.\\d{3})*,\\d{2})`);
                    const match = line.match(regex);
                    if (match) {
                        const row = rubricasTable.querySelector('tbody').insertRow();
                        row.insertCell(0).innerText = rubrica;
                        row.insertCell(1).innerText = rubricasDetalhadas[rubrica];
                        row.insertCell(2).innerText = match[1];
                    }
                });
            });

            container.appendChild(rubricasTable);
        }

        function gerarTabelaProventosPorData() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Proventos</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const rubrica = line.substring(0, 4);
                    if (['0001', '0002', '0003', '0004', '0005', '0007', '0008', '0009', '0010', '0011', '0012', '0013', '0015', '0022', '3036''].includes(rubrica)) {
                        const values = line.match(/\d{1,3}(?:\.\d{3})*,\d{2}/g);
                        if (values && values[0]) {
                            totalProventos += parseFloat(values[0].replace(/\./g, '').replace(',', '.'));
                        }
                    }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabla para o titular
        function gerarTabelaMensalidades7033() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Titular</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7033.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7033" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para conjuge
function gerarTabelaMensalidades7035() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Cônjuge</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7035.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7035" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Agregado Jovem
function gerarTabelaMensalidades7038() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Agregado Jovem</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7038.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou a rubrica seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }
        
//gera tabela para Agregado Maior
function gerarTabelaMensalidades7039() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Agregado Maior</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7039.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7039" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Dependente
function gerarTabelaMensalidades7034() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Dependente</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7034.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7034" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Planserv Especial
function gerarTabelaMensalidades7037() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Planserv Especial</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7037.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7037" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Co-participação Planserv
function gerarTabelaMensalidades7040() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Co-participação</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7040.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7040" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Planserv Retroativo
function gerarTabelaMensalidades7049() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Retroativo</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7049.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7049" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Parc Risco Titul
function gerarTabelaMensalidades7088() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Parc Risco Titular</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7088.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7088" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Parc Risco Planserv Conj
function gerarTabelaMensalidades7090() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Parc Risco Cônjuge</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7090.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7089" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Parc Risco Planserv Dep
function gerarTabelaMensalidades7089() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Parc Risco Dependente</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7089.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7088" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Parc Risco Planserv Agreg
function gerarTabelaMensalidades7091() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Parc Risco Agregados</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7091.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7091" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

//gera tabela para Restituição Planserv
function gerarTabelaMensalidades7044() {
            const container = document.getElementById('topTables');
            const tabelaProventos = document.createElement('table');
            tabelaProventos.innerHTML = `
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Restituição Planserv</th>
                    </tr>
                </thead>
                <tbody></tbody>
            `;
            Object.keys(resultadosFiltrados).forEach(mesAno => {
                const data = resultadosFiltrados[mesAno];
                const lines = data.split('\n');
                let totalProventos = 0;

                lines.forEach(line => {
                    const match = line.match(/7044.*?(\d{1,3}(?:\.\d{3})*,\d{2})/);
                     if (match && match[1]) { // Verifica se encontrou "7044" seguido por um valor numérico
                     const value = match[1]; // O valor numérico encontrado depois da rubrica
                   totalProventos += parseFloat(value.replace(/\./g, '').replace(',', '.'));
                  }
                });

                const row = tabelaProventos.querySelector('tbody').insertRow();
                const dataCell = row.insertCell(0);
                const proventosCell = row.insertCell(1);
                dataCell.classList.add('no-copy'); // Adiciona a classe no-copy à célula de data
                dataCell.textContent = converterDataParaNumerico(mesAno);
                proventosCell.textContent = totalProventos.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            });

            container.innerHTML = ''; // Limpa antes de adicionar a nova tabela
            container.appendChild(tabelaProventos);
        }

    </script>
</head>
<body>
    <h1> <img src="../imagens/rh_bahia.png" width="50" height="35"> Filtro de Rubricas e Isolamento de Valores</h1>
    <textarea id="inputText" placeholder="Insira a lista bruta aqui..."></textarea><br>
    <button onclick="buscarRubricas()">Buscar</button><br>
    <button onclick="gerarTabelaProventosPorData()">Gerar Tabela de Proventos por Data</button>
    <button onclick="gerarTabelaMensalidades7033()">Gerar Tabela TITULAR</button>
    <button onclick="gerarTabelaMensalidades7035()">Gerar Tabela CÔNJUGE</button>
    <button onclick="gerarTabelaMensalidades7038()">Gerar Tabela AGREGADO JOVEM</button>
    <button onclick="gerarTabelaMensalidades7039()">Gerar Tabela AGREGADO MAIOR</button>
    <button onclick="gerarTabelaMensalidades7034()">Gerar Tabela DEPENDENTE</button>
    <button onclick="gerarTabelaMensalidades7037()">Gerar Tabela ACOMODAÇÃO</button>
    <button onclick="gerarTabelaMensalidades7040()">Gerar Tabela CO-PARTICIPÇÃO</button>
    <button onclick="gerarTabelaMensalidades7088()">Gerar Tabela PARC. RISCO TITULAR</button>
    <button onclick="gerarTabelaMensalidades7090()">Gerar Tabela PARC. RISCO CÔNJUGE</button>
    <button onclick="gerarTabelaMensalidades7089()">Gerar Tabela PARC. RISCO DEPENDENTE</button>
    <button onclick="gerarTabelaMensalidades7091()">Gerar Tabela PARC. RISCO AGREGADO</button><br>
    <button onclick="gerarTabelaMensalidades7049()" style="color: black; border: 1px solid red;"><strong>Gerar Tabela RETROATIVO</strong></button>
    <button onclick="gerarTabelaMensalidades7044()" style="color: black; border: 1px solid red;"><strong>Gerar Tabela RESTITUIÇÕES</strong></button>
    <br>
    <br>
    
    <!-- Incluso um menu minimizavei para indormações e materiais de apoio -->
    <div class="menu-container">
        <button class="menu-toggle">☰ Material de Apoio</button>
            <ul class="menu-list hidden">
              <li><a href="https://docs.google.com/spreadsheets/d/1f1g1hFI_tSsJfbYtDmC4qBdgnSqBzRe6/edit?gid=960815878#gid=960815878" target="_blank"> <img src="../imagens/planilha_financeira.png" width="100" height="100"> Modelo de Planilha Financeira - Restituição (faça uma copia). </a></li>
              <li><a href="https://docs.google.com/spreadsheets/d/1r8sLF3AV3oBv4li8KFUHgbCdpHTzx2GsWtLkXF4yCL4/edit?gid=632666607#gid=632666607" target="_blank"> <img src="../imagens/calculadora.png" width="100" height="100"> Planilha de Cálculo - Restituição (faça uma copia).</a></li>
              <li><a href="https://docs.google.com/document/d/1mJAWaJzSm85sELak7Q4720VhnOi-7gXf/edit" target="_blank"> <img src="../imagens/despacho.png" width="100" height="100"> Modelo de Despacho Deferimento - Restituição (faça uma copia).</a></li>
              <li><a href="https://docs.google.com/document/d/1J57DQGl-2y4GrlweRitUjF3dqBS0Vbm9PluCs0p3odE/edit?tab=t.0" target="_blank"> <img src="../imagens/despacho.png" width="100" height="100"> Modelo de Despacho Indeferimento - Restituição (faça uma copia).</a></li>
            </ul>
  </div>
    <script src="../script.js"></script>

    
    <!-- INFORMATIVOS -->    
    <br>
    <h2>⚠️ ATENÇÃO</h2>
    <p>Sempre verifique se não há restituições ou retroativos nos contracheques. Basta clicar nos botões "Gerar Tabela RESTITUIÇÕES" e "Gerar Tabela RETROATIVO"</p>
    <p>Necessario verificar as RUBRICAS que incidem somente apartir de JUNHO 2024 <strong class="destaque_vermelho">para REDAs</strong></p>
    <div id="topTables"></div> <!-- Adiciona o container onde as tabelas serão exibidas -->
    <div id="result"></div>
    <div id="footer">Criado por Marcos Oliveira</div>
</body>
</html>
